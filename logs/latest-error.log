+ COMMAND_STANDALONE=standalone-job
+ COMMAND_HISTORY_SERVER=history-server
++ hostname -f
+ JOB_MANAGER_RPC_ADDRESS=flink-kafka-s3-6cc94dcddd-wxp9z
+ CONF_FILE=/usr/lib/flink/conf/flink-conf.yaml
+ maybe_enable_jemalloc
+ '[' false == false ']'
++ uname -m
+ JEMALLOC_PATH=/usr/lib/x86_64-linux-gnu/libjemalloc.so
+ JEMALLOC_FALLBACK=/usr/lib64/libjemalloc.so
+ '[' -f /usr/lib/x86_64-linux-gnu/libjemalloc.so ']'
+ '[' -f /usr/lib64/libjemalloc.so ']'
+ export LD_PRELOAD=:/usr/lib64/libjemalloc.so
+ LD_PRELOAD=:/usr/lib64/libjemalloc.so
+ copy_plugins_if_required
+ '[' -z '' ']'
+ return 0
+ prepare_configuration
+ set_config_option jobmanager.rpc.address flink-kafka-s3-6cc94dcddd-wxp9z
+ local option=jobmanager.rpc.address
+ local value=flink-kafka-s3-6cc94dcddd-wxp9z
++ echo jobmanager.rpc.address
++ sed -e 's/\./\\./g'
+ local 'escaped_option=jobmanager\.rpc\.address'
+ grep -E '^jobmanager\.rpc\.address:.*' /usr/lib/flink/conf/flink-conf.yaml
+ echo 'jobmanager.rpc.address: flink-kafka-s3-6cc94dcddd-wxp9z'
/docker-entrypoint.sh: line 65: /usr/lib/flink/conf/flink-conf.yaml: Permission denied
+ set_config_option blob.server.port 6124
+ local option=blob.server.port
+ local value=6124
++ echo blob.server.port
++ sed -e 's/\./\\./g'
+ local 'escaped_option=blob\.server\.port'
+ grep -E '^blob\.server\.port:.*' /usr/lib/flink/conf/flink-conf.yaml
+ sed -i -e 's/blob\.server\.port:.*/blob.server.port: 6124/g' /usr/lib/flink/conf/flink-conf.yaml
sed: couldn't open temporary file /usr/lib/flink/conf/sed4GJVgE: Read-only file system
+ set_config_option query.server.port 6125
+ local option=query.server.port
+ local value=6125
++ echo query.server.port
++ sed -e 's/\./\\./g'
+ local 'escaped_option=query\.server\.port'
+ grep -E '^query\.server\.port:.*' /usr/lib/flink/conf/flink-conf.yaml
+ echo 'query.server.port: 6125'
/docker-entrypoint.sh: line 65: /usr/lib/flink/conf/flink-conf.yaml: Permission denied
+ '[' -n '' ']'
+ '[' -n '' ']'
+ envsubst
/docker-entrypoint.sh: line 81: /usr/lib/flink/conf/flink-conf.yaml.tmp: Read-only file system
+ args=("$@")
+ '[' bash = help ']'
+ '[' bash = jobmanager ']'
Starting Job Manager on K8s
+ [[ bash -c kubernetes-jobmanager.sh kubernetes-application  == *\k\u\b\e\r\n\e\t\e\s\-\j\o\b\m\a\n\a\g\e\r* ]]
+ echo 'Starting Job Manager on K8s'
+ CMD=("${args[@]}")
+ DISABLE_STDOUT_STDERR=0
+ '[' -z /var/log/flink/user/stdout ']'
+ '[' -z /var/log/flink/user/stderr ']'
+ mkdir -p /var/log/flink/user/stderr /var/log/flink/user/stdout
+ chmod 777 /var/log/flink/user/stderr /var/log/flink/user/stdout
+ '[' -z '' ']'
+ echo 'Not enabling AWS Glue Catalog support...'
+ '[' -z '' ']'
Not enabling AWS Glue Catalog support...
+ echo 'Not enabling Hudi support'
+ '[' -z '' ']'
+ echo 'Not enabling Delta Lake support...'
+ '[' -z '' ']'
+ echo 'Not enabling Iceberg support...'
Not enabling Hudi support
+ (( 0 ))
Not enabling Delta Lake support...
Not enabling Iceberg support...
+ exec /usr/bin/tini -s -- bash -c 'kubernetes-jobmanager.sh kubernetes-application '
++ tee /dev/fd/63
+++ multilog s2147483648 n10 /var/log/flink/user/stdout
++ tee /dev/fd/62
+++ multilog s2147483648 n10 /var/log/flink/user/stderr
Setting HADOOP_CONF_DIR=/etc/hadoop/conf because no HADOOP_CONF_DIR or HADOOP_CLASSPATH was set.
Setting HADOOP_CONF_DIR=/etc/hadoop/conf because no HADOOP_CONF_DIR or HADOOP_CLASSPATH was set.
Starting kubernetes-application as a console application on host flink-kafka-s3-6cc94dcddd-wxp9z.
2025-08-06 08:39:01,323 INFO  org.apache.flink.runtime.entrypoint.ClusterEntrypoint        [] - --------------------------------------------------------------------------------
2025-08-06 08:39:01,325 INFO  org.apache.flink.runtime.entrypoint.ClusterEntrypoint        [] -  Preconfiguration: 
2025-08-06 08:39:01,325 INFO  org.apache.flink.runtime.entrypoint.ClusterEntrypoint        [] - 


RESOURCE_PARAMS extraction logs:
jvm_params: -Xmx1530082096 -Xms1530082096 -XX:MaxMetaspaceSize=268435456
dynamic_configs: -D jobmanager.memory.off-heap.size=134217728b -D jobmanager.memory.jvm-overhead.min=214748368b -D jobmanager.memory.jvm-metaspace.size=268435456b -D jobmanager.memory.heap.size=1530082096b -D jobmanager.memory.jvm-overhead.max=214748368b
logs: WARNING: sun.reflect.Reflection.getCallerClass is not supported. This will impact performance.
INFO  [] - Using legacy YAML parser to load flink configuration file from /usr/lib/flink/conf/flink-conf.yaml.
INFO  [] - Loading configuration property: task.local-recovery.ebs.enable, true
INFO  [] - Loading configuration property: kubernetes.jobmanager.replicas, 2
INFO  [] - Loading configuration property: kubernetes.taskmanager.service-account, emr-containers-sa-flink-taskmanager-021732063925-1sseqknnoni14bdu6yyw9n3ft32986beoj10gadqfez009x
INFO  [] - Loading configuration property: execution.submit-failed-job-on-application-error, true
INFO  [] - Loading configuration property: job.autoscaler.decision.interval", 10s
INFO  [] - Loading configuration property: pipeline.operator-chaining, false
INFO  [] - Loading configuration property: restart-strategy.type, fixed-delay
INFO  [] - Loading configuration property: high-availability.cluster-id, flink-kafka-s3
INFO  [] - Loading configuration property: pipeline.max-parallelism, 64
INFO  [] - Loading configuration property: kubernetes.service-account, emr-containers-sa-flink-jobmanager-021732063925-1sseqknnoni14bdu6yyw9n3ft32986beoj10gadqfez009x
INFO  [] - Loading configuration property: kubernetes.cluster-id, flink-kafka-s3
INFO  [] - Loading configuration property: dstl.dfs.base-path, s3://emr-on-eks-test-021732063925-us-west-2/flink/autoscaling/kafka-s3/changelog
INFO  [] - Loading configuration property: high-availability.storageDir, s3://emr-on-eks-test-021732063925-us-west-2/flink/autoscaling/kafka-s3/ha/
INFO  [] - Loading configuration property: kubernetes.taskmanager.local-recovery.persistentVolumeClaim.sizeLimit, 10Gi
INFO  [] - Loading configuration property: kubernetes.taskmanager.cpu.amount, 1.0
INFO  [] - Loading configuration property: parallelism.default, 1
INFO  [] - Loading configuration property: kubernetes.namespace, emr-flink
INFO  [] - Loading configuration property: fs.s3a.aws.credentials.provider, software.amazon.awssdk.auth.credentials.WebIdentityTokenFileCredentialsProvider
INFO  [] - Loading configuration property: kubernetes.jobmanager.owner.reference, uid:a2534eb8-3639-4770-bb72-be12d1e08cc1,name:flink-kafka-s3,controller:false,blockOwnerDeletion:true,apiVersion:flink.apache.org/v1beta1,kind:FlinkDeployment
INFO  [] - Loading configuration property: dstl.dfs.upload.timeout, 5s
INFO  [] - Loading configuration property: jobmanager.adaptive-scheduler.combined-restart.window-interval, 2m
INFO  [] - Loading configuration property: kubernetes.container.image.ref, 021732063925.dkr.ecr.us-west-2.amazonaws.com/emr-7.9.0-flink-msk-s3:latest
INFO  [] - Loading configuration property: taskmanager.memory.process.size, 4 gb
INFO  [] - Loading configuration property: kubernetes.internal.jobmanager.entrypoint.class, org.apache.flink.kubernetes.entrypoint.KubernetesApplicationClusterEntrypoint
INFO  [] - Loading configuration property: job.autoscaler.restart.time-tracking.enabled, true
INFO  [] - Loading configuration property: pipeline.name, flink-kafka-s3
INFO  [] - Loading configuration property: cluster.taskmanager.graceful-decommission.enabled, true
INFO  [] - Loading configuration property: state.backend.local-recovery, true
INFO  [] - Loading configuration property: state.backend.rocksdb.localdir, /tmp/rocksdb/
INFO  [] - Loading configuration property: kubernetes.pod-template-file.taskmanager, /tmp/flink_op_generated_podTemplate_14611689406274480280.yaml
INFO  [] - Loading configuration property: state.backend.incremental, true
INFO  [] - Loading configuration property: web.cancel.enable, false
INFO  [] - Loading configuration property: execution.shutdown-on-application-finish, false
INFO  [] - Loading configuration property: execution.checkpointing.interval, 30000
INFO  [] - Loading configuration property: kubernetes.container.image.pull-policy, Always
INFO  [] - Loading configuration property: kubernetes.jobmanager.cpu.amount, 1.0
INFO  [] - Loading configuration property: job-result-store.delete-on-commit, false
INFO  [] - Loading configuration property: restart-strategy.fixed-delay.delay, 3 s
INFO  [] - Loading configuration property: $internal.pipeline.job-id, 446371c9b6d0eeaf11ee48aaf61e4d3b
INFO  [] - Loading configuration property: kubernetes.taskmanager.labels, emr-containers.amazonaws.com/component:flink.taskmanager,emr-containers.amazonaws.com/resource.type:flink.operator
INFO  [] - Loading configuration property: kubernetes.jobmanager.service-account, emr-containers-sa-flink-jobmanager-021732063925-1sseqknnoni14bdu6yyw9n3ft32986beoj10gadqfez009x
INFO  [] - Loading configuration property: state.backend, rocksdb
INFO  [] - Loading configuration property: $internal.flink.version, v1_19
INFO  [] - Loading configuration property: kubernetes.pod-template-file.jobmanager, /tmp/flink_op_generated_podTemplate_8594828908694364009.yaml
INFO  [] - Loading configuration property: blob.server.port, 6124
INFO  [] - Loading configuration property: kubernetes.jobmanager.annotations, flinkdeployment.flink.apache.org/generation:2
INFO  [] - Loading configuration property: job-result-store.storage-path, s3://emr-on-eks-test-021732063925-us-west-2/flink/autoscaling/kafka-s3/ha//job-result-store/flink-kafka-s3/4cb8e79a-b379-49c6-bc44-e494b583e663
INFO  [] - Loading configuration property: high-availability.type, kubernetes
INFO  [] - Loading configuration property: jobmanager.execution.failover-strategy, region
INFO  [] - Loading configuration property: state.backend.changelog.enabled, true
INFO  [] - Loading configuration property: kubernetes.jobmanager.labels, emr-containers.amazonaws.com/component:flink.jobmanager,emr-containers.amazonaws.com/resource.type:flink.operator
INFO  [] - Loading configuration property: state.savepoints.dir, s3://emr-on-eks-test-021732063925-us-west-2/autoscaling/kafka-s3/savepoint/
INFO  [] - Loading configuration property: job.autoscaler.scale-down.interval, 0
INFO  [] - Loading configuration property: $internal.application.program-args, -py;/opt/flink/usrlib/kafka-s3-sink-flink1-19.py;b-2.emrstreamdemo.5uk6mr.c1.kafka.us-west-2.amazonaws.com:9092,b-1.emrstreamdemo.5uk6mr.c1.kafka.us-west-2.amazonaws.com:9092;flink-consumer-g1;earliest-offset;s3://emr-on-eks-test-021732063925-us-west-2/orders_data_parquet/
INFO  [] - Loading configuration property: jobmanager.adaptive-scheduler.combined-restart.enabled, true
INFO  [] - Loading configuration property: taskmanager.numberOfTaskSlots, 4
INFO  [] - Loading configuration property: kubernetes.rest-service.exposed.type, ClusterIP
INFO  [] - Loading configuration property: high-availability.jobmanager.port, 6123
INFO  [] - Loading configuration property: $internal.application.main, org.apache.flink.client.python.PythonDriver
INFO  [] - Loading configuration property: restart-strategy.fixed-delay.attempts, 100
INFO  [] - Loading configuration property: execution.target, kubernetes-application
INFO  [] - Loading configuration property: jobmanager.memory.process.size, 2 gb
INFO  [] - Loading configuration property: taskmanager.rpc.port, 6122
INFO  [] - Loading configuration property: state.backend.changelog.storage, filesystem
INFO  [] - Loading configuration property: internal.cluster.execution-mode, NORMAL
INFO  [] - Loading configuration property: jobmanager.scheduler, adaptive
INFO  [] - Loading configuration property: execution.checkpointing.externalized-checkpoint-retention, RETAIN_ON_CANCELLATION
INFO  [] - Loading configuration property: job.autoscaler.restart.time-tracking.limit, 5m
INFO  [] - Loading configuration property: pipeline.jars, local:///opt/flink/usrlib/kafka-s3-sink-flink1-19.py
INFO  [] - Loading configuration property: fs.s3a.endpoint.region, us-west-2
INFO  [] - Loading configuration property: state.checkpoints.dir, s3p://emr-on-eks-test-021732063925-us-west-2/flink/autoscaling/kafka-s3/checkpoint
INFO  [] - Final Master Memory configuration:
INFO  [] -   Total Process Memory: 2.000gb (2147483648 bytes)
INFO  [] -     Total Flink Memory: 1.550gb (1664299824 bytes)
INFO  [] -       JVM Heap:         1.425gb (1530082096 bytes)
INFO  [] -       Off-heap:         128.000mb (134217728 bytes)
INFO  [] -     JVM Metaspace:      256.000mb (268435456 bytes)
INFO  [] -     JVM Overhead:       204.800mb (214748368 bytes)

2025-08-06 08:39:01,325 INFO  org.apache.flink.runtime.entrypoint.ClusterEntrypoint        [] - --------------------------------------------------------------------------------
2025-08-06 08:39:01,326 INFO  org.apache.flink.runtime.entrypoint.ClusterEntrypoint        [] -  Starting KubernetesApplicationClusterEntrypoint (Version: 1.20.0-amzn-3, Scala: 2.12, Rev:b741e9c, Date:2025-05-06T16:18:37+02:00)
2025-08-06 08:39:01,326 INFO  org.apache.flink.runtime.entrypoint.ClusterEntrypoint        [] -  OS current user: hadoop
2025-08-06 08:39:01,326 INFO  org.apache.flink.runtime.entrypoint.ClusterEntrypoint        [] -  Current Hadoop/Kerberos user: <no hadoop dependency found>
2025-08-06 08:39:01,326 INFO  org.apache.flink.runtime.entrypoint.ClusterEntrypoint        [] -  JVM: OpenJDK 64-Bit Server VM - Amazon.com Inc. - 17/17.0.15+6-LTS
2025-08-06 08:39:01,326 INFO  org.apache.flink.runtime.entrypoint.ClusterEntrypoint        [] -  Arch: amd64
2025-08-06 08:39:01,326 INFO  org.apache.flink.runtime.entrypoint.ClusterEntrypoint        [] -  Maximum heap size: 1411 MiBytes
2025-08-06 08:39:01,326 INFO  org.apache.flink.runtime.entrypoint.ClusterEntrypoint        [] -  JAVA_HOME: /usr/lib/jvm/java-17-amazon-corretto
2025-08-06 08:39:01,326 INFO  org.apache.flink.runtime.entrypoint.ClusterEntrypoint        [] -  No Hadoop Dependency available
2025-08-06 08:39:01,326 INFO  org.apache.flink.runtime.entrypoint.ClusterEntrypoint        [] -  JVM Options:
2025-08-06 08:39:01,327 INFO  org.apache.flink.runtime.entrypoint.ClusterEntrypoint        [] -     -Xmx1530082096
2025-08-06 08:39:01,327 INFO  org.apache.flink.runtime.entrypoint.ClusterEntrypoint        [] -     -Xms1530082096
2025-08-06 08:39:01,327 INFO  org.apache.flink.runtime.entrypoint.ClusterEntrypoint        [] -     -XX:MaxMetaspaceSize=268435456
2025-08-06 08:39:01,327 INFO  org.apache.flink.runtime.entrypoint.ClusterEntrypoint        [] -     --add-exports=java.base/sun.net.util=ALL-UNNAMED
2025-08-06 08:39:01,327 INFO  org.apache.flink.runtime.entrypoint.ClusterEntrypoint        [] -     --add-exports=java.rmi/sun.rmi.registry=ALL-UNNAMED
2025-08-06 08:39:01,327 INFO  org.apache.flink.runtime.entrypoint.ClusterEntrypoint        [] -     --add-exports=jdk.compiler/com.sun.tools.javac.api=ALL-UNNAMED
2025-08-06 08:39:01,327 INFO  org.apache.flink.runtime.entrypoint.ClusterEntrypoint        [] -     --add-exports=jdk.compiler/com.sun.tools.javac.file=ALL-UNNAMED
2025-08-06 08:39:01,327 INFO  org.apache.flink.runtime.entrypoint.ClusterEntrypoint        [] -     --add-exports=jdk.compiler/com.sun.tools.javac.parser=ALL-UNNAMED
2025-08-06 08:39:01,327 INFO  org.apache.flink.runtime.entrypoint.ClusterEntrypoint        [] -     --add-exports=jdk.compiler/com.sun.tools.javac.tree=ALL-UNNAMED
2025-08-06 08:39:01,327 INFO  org.apache.flink.runtime.entrypoint.ClusterEntrypoint        [] -     --add-exports=jdk.compiler/com.sun.tools.javac.util=ALL-UNNAMED
2025-08-06 08:39:01,327 INFO  org.apache.flink.runtime.entrypoint.ClusterEntrypoint        [] -     --add-exports=java.security.jgss/sun.security.krb5=ALL-UNNAMED
2025-08-06 08:39:01,328 INFO  org.apache.flink.runtime.entrypoint.ClusterEntrypoint        [] -     --add-opens=java.base/java.lang=ALL-UNNAMED
2025-08-06 08:39:01,328 INFO  org.apache.flink.runtime.entrypoint.ClusterEntrypoint        [] -     --add-opens=java.base/java.net=ALL-UNNAMED
2025-08-06 08:39:01,328 INFO  org.apache.flink.runtime.entrypoint.ClusterEntrypoint        [] -     --add-opens=java.base/java.io=ALL-UNNAMED
2025-08-06 08:39:01,328 INFO  org.apache.flink.runtime.entrypoint.ClusterEntrypoint        [] -     --add-opens=java.base/java.nio=ALL-UNNAMED
2025-08-06 08:39:01,328 INFO  org.apache.flink.runtime.entrypoint.ClusterEntrypoint        [] -     --add-opens=java.base/sun.nio.ch=ALL-UNNAMED
2025-08-06 08:39:01,328 INFO  org.apache.flink.runtime.entrypoint.ClusterEntrypoint        [] -     --add-opens=java.base/java.lang.reflect=ALL-UNNAMED
2025-08-06 08:39:01,328 INFO  org.apache.flink.runtime.entrypoint.ClusterEntrypoint        [] -     --add-opens=java.base/java.text=ALL-UNNAMED
2025-08-06 08:39:01,328 INFO  org.apache.flink.runtime.entrypoint.ClusterEntrypoint        [] -     --add-opens=java.base/java.time=ALL-UNNAMED
2025-08-06 08:39:01,328 INFO  org.apache.flink.runtime.entrypoint.ClusterEntrypoint        [] -     --add-opens=java.base/java.util=ALL-UNNAMED
2025-08-06 08:39:01,328 INFO  org.apache.flink.runtime.entrypoint.ClusterEntrypoint        [] -     --add-opens=java.base/java.util.concurrent=ALL-UNNAMED
2025-08-06 08:39:01,328 INFO  org.apache.flink.runtime.entrypoint.ClusterEntrypoint        [] -     --add-opens=java.base/java.util.concurrent.atomic=ALL-UNNAMED
2025-08-06 08:39:01,328 INFO  org.apache.flink.runtime.entrypoint.ClusterEntrypoint        [] -     --add-opens=java.base/java.util.concurrent.locks=ALL-UNNAMED
2025-08-06 08:39:01,329 INFO  org.apache.flink.runtime.entrypoint.ClusterEntrypoint        [] -     -Dlog.file=/usr/lib/flink/log/flink--kubernetes-application-0-flink-kafka-s3-6cc94dcddd-wxp9z.log
2025-08-06 08:39:01,329 INFO  org.apache.flink.runtime.entrypoint.ClusterEntrypoint        [] -     -Dlog4j.configuration=file:/usr/lib/flink/conf/log4j-console.properties
2025-08-06 08:39:01,329 INFO  org.apache.flink.runtime.entrypoint.ClusterEntrypoint        [] -     -Dlog4j.configurationFile=file:/usr/lib/flink/conf/log4j-console.properties
2025-08-06 08:39:01,329 INFO  org.apache.flink.runtime.entrypoint.ClusterEntrypoint        [] -     -Dlogback.configurationFile=file:/usr/lib/flink/conf/logback-console.xml
2025-08-06 08:39:01,329 INFO  org.apache.flink.runtime.entrypoint.ClusterEntrypoint        [] -  Program Arguments:
2025-08-06 08:39:01,330 INFO  org.apache.flink.runtime.entrypoint.ClusterEntrypoint        [] -     -D
2025-08-06 08:39:01,330 INFO  org.apache.flink.runtime.entrypoint.ClusterEntrypoint        [] -     jobmanager.memory.off-heap.size=134217728b
2025-08-06 08:39:01,330 INFO  org.apache.flink.runtime.entrypoint.ClusterEntrypoint        [] -     -D
2025-08-06 08:39:01,330 INFO  org.apache.flink.runtime.entrypoint.ClusterEntrypoint        [] -     jobmanager.memory.jvm-overhead.min=214748368b
2025-08-06 08:39:01,330 INFO  org.apache.flink.runtime.entrypoint.ClusterEntrypoint        [] -     -D
2025-08-06 08:39:01,330 INFO  org.apache.flink.runtime.entrypoint.ClusterEntrypoint        [] -     jobmanager.memory.jvm-metaspace.size=268435456b
2025-08-06 08:39:01,330 INFO  org.apache.flink.runtime.entrypoint.ClusterEntrypoint        [] -     -D
2025-08-06 08:39:01,330 INFO  org.apache.flink.runtime.entrypoint.ClusterEntrypoint        [] -     jobmanager.memory.heap.size=1530082096b
2025-08-06 08:39:01,330 INFO  org.apache.flink.runtime.entrypoint.ClusterEntrypoint        [] -     -D
2025-08-06 08:39:01,330 INFO  org.apache.flink.runtime.entrypoint.ClusterEntrypoint        [] -     jobmanager.memory.jvm-overhead.max=214748368b
2025-08-06 08:39:01,331 INFO  org.apache.flink.runtime.entrypoint.ClusterEntrypoint        [] -  Classpath: /usr/lib/flink/lib/flink-cep-1.20.0-amzn-3.jar:/usr/lib/flink/lib/flink-connector-files-1.20.0-amzn-3.jar:/usr/lib/flink/lib/flink-csv-1.20.0-amzn-3.jar:/usr/lib/flink/lib/flink-json-1.20.0-amzn-3.jar:/usr/lib/flink/lib/flink-parquet.jar:/usr/lib/flink/lib/flink-scala_2.12-1.20.0-amzn-3.jar:/usr/lib/flink/lib/flink-sql-connector-kafka.jar:/usr/lib/flink/lib/flink-table-api-java-uber-1.20.0-amzn-3.jar:/usr/lib/flink/lib/flink-table-api-scala-bridge_2.12-1.20.0-amzn-3.jar:/usr/lib/flink/lib/flink-table-planner-loader-1.20.0-amzn-3.jar:/usr/lib/flink/lib/flink-table-runtime-1.20.0-amzn-3.jar:/usr/lib/flink/lib/log4j-1.2-api-2.17.1.jar:/usr/lib/flink/lib/log4j-api-2.17.1.jar:/usr/lib/flink/lib/log4j-core-2.17.1.jar:/usr/lib/flink/lib/log4j-slf4j-impl-2.17.1.jar:/usr/lib/flink/lib/flink-dist-1.20.0-amzn-3.jar:::/etc/hadoop/conf:
2025-08-06 08:39:01,331 INFO  org.apache.flink.runtime.entrypoint.ClusterEntrypoint        [] - --------------------------------------------------------------------------------
2025-08-06 08:39:01,331 INFO  org.apache.flink.runtime.entrypoint.ClusterEntrypoint        [] - Registered UNIX signal handlers for [TERM, HUP, INT]
2025-08-06 08:39:01,340 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Using legacy YAML parser to load flink configuration file from /usr/lib/flink/conf/flink-conf.yaml.
2025-08-06 08:39:01,342 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: task.local-recovery.ebs.enable, true
2025-08-06 08:39:01,342 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: kubernetes.jobmanager.replicas, 2
2025-08-06 08:39:01,342 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: kubernetes.taskmanager.service-account, emr-containers-sa-flink-taskmanager-021732063925-1sseqknnoni14bdu6yyw9n3ft32986beoj10gadqfez009x
2025-08-06 08:39:01,342 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: execution.submit-failed-job-on-application-error, true
2025-08-06 08:39:01,342 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: job.autoscaler.decision.interval", 10s
2025-08-06 08:39:01,342 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: pipeline.operator-chaining, false
2025-08-06 08:39:01,342 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: restart-strategy.type, fixed-delay
2025-08-06 08:39:01,342 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: high-availability.cluster-id, flink-kafka-s3
2025-08-06 08:39:01,342 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: pipeline.max-parallelism, 64
2025-08-06 08:39:01,343 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: kubernetes.service-account, emr-containers-sa-flink-jobmanager-021732063925-1sseqknnoni14bdu6yyw9n3ft32986beoj10gadqfez009x
2025-08-06 08:39:01,343 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: kubernetes.cluster-id, flink-kafka-s3
2025-08-06 08:39:01,343 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: dstl.dfs.base-path, s3://emr-on-eks-test-021732063925-us-west-2/flink/autoscaling/kafka-s3/changelog
2025-08-06 08:39:01,343 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: high-availability.storageDir, s3://emr-on-eks-test-021732063925-us-west-2/flink/autoscaling/kafka-s3/ha/
2025-08-06 08:39:01,343 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: kubernetes.taskmanager.local-recovery.persistentVolumeClaim.sizeLimit, 10Gi
2025-08-06 08:39:01,343 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: kubernetes.taskmanager.cpu.amount, 1.0
2025-08-06 08:39:01,343 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: parallelism.default, 1
2025-08-06 08:39:01,343 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: kubernetes.namespace, emr-flink
2025-08-06 08:39:01,343 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: fs.s3a.aws.credentials.provider, software.amazon.awssdk.auth.credentials.WebIdentityTokenFileCredentialsProvider
2025-08-06 08:39:01,343 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: kubernetes.jobmanager.owner.reference, uid:a2534eb8-3639-4770-bb72-be12d1e08cc1,name:flink-kafka-s3,controller:false,blockOwnerDeletion:true,apiVersion:flink.apache.org/v1beta1,kind:FlinkDeployment
2025-08-06 08:39:01,343 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: dstl.dfs.upload.timeout, 5s
2025-08-06 08:39:01,343 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: jobmanager.adaptive-scheduler.combined-restart.window-interval, 2m
2025-08-06 08:39:01,344 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: kubernetes.container.image.ref, 021732063925.dkr.ecr.us-west-2.amazonaws.com/emr-7.9.0-flink-msk-s3:latest
2025-08-06 08:39:01,344 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: taskmanager.memory.process.size, 4 gb
2025-08-06 08:39:01,344 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: kubernetes.internal.jobmanager.entrypoint.class, org.apache.flink.kubernetes.entrypoint.KubernetesApplicationClusterEntrypoint
2025-08-06 08:39:01,344 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: job.autoscaler.restart.time-tracking.enabled, true
2025-08-06 08:39:01,344 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: pipeline.name, flink-kafka-s3
2025-08-06 08:39:01,344 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: cluster.taskmanager.graceful-decommission.enabled, true
2025-08-06 08:39:01,344 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: state.backend.local-recovery, true
2025-08-06 08:39:01,344 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: state.backend.rocksdb.localdir, /tmp/rocksdb/
2025-08-06 08:39:01,344 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: kubernetes.pod-template-file.taskmanager, /tmp/flink_op_generated_podTemplate_14611689406274480280.yaml
2025-08-06 08:39:01,344 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: state.backend.incremental, true
2025-08-06 08:39:01,344 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: web.cancel.enable, false
2025-08-06 08:39:01,344 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: execution.shutdown-on-application-finish, false
2025-08-06 08:39:01,345 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: execution.checkpointing.interval, 30000
2025-08-06 08:39:01,345 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: kubernetes.container.image.pull-policy, Always
2025-08-06 08:39:01,345 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: kubernetes.jobmanager.cpu.amount, 1.0
2025-08-06 08:39:01,345 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: job-result-store.delete-on-commit, false
2025-08-06 08:39:01,345 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: restart-strategy.fixed-delay.delay, 3 s
2025-08-06 08:39:01,345 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: $internal.pipeline.job-id, 446371c9b6d0eeaf11ee48aaf61e4d3b
2025-08-06 08:39:01,345 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: kubernetes.taskmanager.labels, emr-containers.amazonaws.com/component:flink.taskmanager,emr-containers.amazonaws.com/resource.type:flink.operator
2025-08-06 08:39:01,345 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: kubernetes.jobmanager.service-account, emr-containers-sa-flink-jobmanager-021732063925-1sseqknnoni14bdu6yyw9n3ft32986beoj10gadqfez009x
2025-08-06 08:39:01,345 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: state.backend, rocksdb
2025-08-06 08:39:01,345 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: $internal.flink.version, v1_19
2025-08-06 08:39:01,346 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: kubernetes.pod-template-file.jobmanager, /tmp/flink_op_generated_podTemplate_8594828908694364009.yaml
2025-08-06 08:39:01,346 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: blob.server.port, 6124
2025-08-06 08:39:01,346 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: kubernetes.jobmanager.annotations, flinkdeployment.flink.apache.org/generation:2
2025-08-06 08:39:01,346 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: job-result-store.storage-path, s3://emr-on-eks-test-021732063925-us-west-2/flink/autoscaling/kafka-s3/ha//job-result-store/flink-kafka-s3/4cb8e79a-b379-49c6-bc44-e494b583e663
2025-08-06 08:39:01,346 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: high-availability.type, kubernetes
2025-08-06 08:39:01,346 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: jobmanager.execution.failover-strategy, region
2025-08-06 08:39:01,346 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: state.backend.changelog.enabled, true
2025-08-06 08:39:01,346 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: kubernetes.jobmanager.labels, emr-containers.amazonaws.com/component:flink.jobmanager,emr-containers.amazonaws.com/resource.type:flink.operator
2025-08-06 08:39:01,346 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: state.savepoints.dir, s3://emr-on-eks-test-021732063925-us-west-2/autoscaling/kafka-s3/savepoint/
2025-08-06 08:39:01,346 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: job.autoscaler.scale-down.interval, 0
2025-08-06 08:39:01,347 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: $internal.application.program-args, -py;/opt/flink/usrlib/kafka-s3-sink-flink1-19.py;b-2.emrstreamdemo.5uk6mr.c1.kafka.us-west-2.amazonaws.com:9092,b-1.emrstreamdemo.5uk6mr.c1.kafka.us-west-2.amazonaws.com:9092;flink-consumer-g1;earliest-offset;s3://emr-on-eks-test-021732063925-us-west-2/orders_data_parquet/
2025-08-06 08:39:01,347 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: jobmanager.adaptive-scheduler.combined-restart.enabled, true
2025-08-06 08:39:01,347 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: taskmanager.numberOfTaskSlots, 4
2025-08-06 08:39:01,347 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: kubernetes.rest-service.exposed.type, ClusterIP
2025-08-06 08:39:01,347 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: high-availability.jobmanager.port, 6123
2025-08-06 08:39:01,347 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: $internal.application.main, org.apache.flink.client.python.PythonDriver
2025-08-06 08:39:01,347 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: restart-strategy.fixed-delay.attempts, 100
2025-08-06 08:39:01,347 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: execution.target, kubernetes-application
2025-08-06 08:39:01,347 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: jobmanager.memory.process.size, 2 gb
2025-08-06 08:39:01,347 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: taskmanager.rpc.port, 6122
2025-08-06 08:39:01,347 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: state.backend.changelog.storage, filesystem
2025-08-06 08:39:01,347 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: internal.cluster.execution-mode, NORMAL
2025-08-06 08:39:01,347 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: jobmanager.scheduler, adaptive
2025-08-06 08:39:01,348 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: execution.checkpointing.externalized-checkpoint-retention, RETAIN_ON_CANCELLATION
2025-08-06 08:39:01,348 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: job.autoscaler.restart.time-tracking.limit, 5m
2025-08-06 08:39:01,348 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: pipeline.jars, local:///opt/flink/usrlib/kafka-s3-sink-flink1-19.py
2025-08-06 08:39:01,348 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: fs.s3a.endpoint.region, us-west-2
2025-08-06 08:39:01,348 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: state.checkpoints.dir, s3p://emr-on-eks-test-021732063925-us-west-2/flink/autoscaling/kafka-s3/checkpoint
2025-08-06 08:39:01,348 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading dynamic configuration property: jobmanager.memory.off-heap.size, 134217728b
2025-08-06 08:39:01,348 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading dynamic configuration property: jobmanager.memory.jvm-overhead.min, 214748368b
2025-08-06 08:39:01,348 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading dynamic configuration property: jobmanager.memory.jvm-metaspace.size, 268435456b
2025-08-06 08:39:01,348 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading dynamic configuration property: jobmanager.memory.heap.size, 1530082096b
2025-08-06 08:39:01,349 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading dynamic configuration property: jobmanager.memory.jvm-overhead.max, 214748368b
2025-08-06 08:39:01,563 INFO  org.apache.flink.runtime.entrypoint.ClusterEntrypoint        [] - Install default filesystem for fetching user artifacts in Kubernetes Application Mode.
2025-08-06 08:39:01,566 INFO  org.apache.flink.core.fs.FileSystem                          [] - Hadoop is not in the classpath/dependencies. The extended set of supported File Systems via Hadoop is not available.
2025-08-06 08:39:01,623 INFO  org.apache.flink.core.plugin.DefaultPluginManager            [] - Plugin loader with ID not found, creating it: external-resource-gpu
2025-08-06 08:39:01,626 INFO  org.apache.flink.core.plugin.DefaultPluginManager            [] - Plugin loader with ID not found, creating it: flink-s3-fs-presto
2025-08-06 08:39:01,627 INFO  org.apache.flink.core.plugin.DefaultPluginManager            [] - Plugin loader with ID not found, creating it: metrics-datadog
2025-08-06 08:39:01,627 INFO  org.apache.flink.core.plugin.DefaultPluginManager            [] - Plugin loader with ID not found, creating it: metrics-graphite
2025-08-06 08:39:01,627 INFO  org.apache.flink.core.plugin.DefaultPluginManager            [] - Plugin loader with ID not found, creating it: metrics-influx
2025-08-06 08:39:01,627 INFO  org.apache.flink.core.plugin.DefaultPluginManager            [] - Plugin loader with ID not found, creating it: metrics-jmx
2025-08-06 08:39:01,627 INFO  org.apache.flink.core.plugin.DefaultPluginManager            [] - Plugin loader with ID not found, creating it: metrics-prometheus
2025-08-06 08:39:01,627 INFO  org.apache.flink.core.plugin.DefaultPluginManager            [] - Plugin loader with ID not found, creating it: metrics-slf4j
2025-08-06 08:39:01,627 INFO  org.apache.flink.core.plugin.DefaultPluginManager            [] - Plugin loader with ID not found, creating it: metrics-statsd
2025-08-06 08:39:01,628 INFO  org.apache.flink.core.plugin.DefaultPluginManager            [] - Plugin loader with ID not found, creating it: s3
2025-08-06 08:39:01,819 INFO  org.apache.flink.runtime.entrypoint.ClusterEntrypoint        [] - Install security context.
2025-08-06 08:39:01,833 INFO  org.apache.flink.runtime.security.modules.HadoopModuleFactory [] - Cannot create Hadoop Security Module because Hadoop cannot be found in the Classpath.
2025-08-06 08:39:01,853 INFO  org.apache.flink.runtime.security.modules.JaasModule         [] - Jaas file will be created as /tmp/jaas-1624840647972546525.conf.
2025-08-06 08:39:01,915 INFO  org.apache.flink.runtime.security.contexts.HadoopSecurityContextFactory [] - Cannot install HadoopSecurityContext because Hadoop cannot be found in the Classpath.
2025-08-06 08:39:02,037 INFO  org.apache.flink.runtime.entrypoint.ClusterEntrypoint        [] - Starting KubernetesApplicationClusterEntrypoint.
2025-08-06 08:39:02,043 INFO  org.apache.flink.runtime.entrypoint.ClusterEntrypoint        [] - Install default filesystem.
2025-08-06 08:39:02,044 INFO  org.apache.flink.core.plugin.DefaultPluginManager            [] - Plugin loader with ID not found, creating it: external-resource-gpu
2025-08-06 08:39:02,044 INFO  org.apache.flink.core.plugin.DefaultPluginManager            [] - Plugin loader with ID not found, creating it: flink-s3-fs-presto
2025-08-06 08:39:02,044 INFO  org.apache.flink.core.plugin.DefaultPluginManager            [] - Plugin loader with ID not found, creating it: metrics-datadog
2025-08-06 08:39:02,044 INFO  org.apache.flink.core.plugin.DefaultPluginManager            [] - Plugin loader with ID not found, creating it: metrics-graphite
2025-08-06 08:39:02,044 INFO  org.apache.flink.core.plugin.DefaultPluginManager            [] - Plugin loader with ID not found, creating it: metrics-influx
2025-08-06 08:39:02,044 INFO  org.apache.flink.core.plugin.DefaultPluginManager            [] - Plugin loader with ID not found, creating it: metrics-jmx
2025-08-06 08:39:02,045 INFO  org.apache.flink.core.plugin.DefaultPluginManager            [] - Plugin loader with ID not found, creating it: metrics-prometheus
2025-08-06 08:39:02,045 INFO  org.apache.flink.core.plugin.DefaultPluginManager            [] - Plugin loader with ID not found, creating it: metrics-slf4j
2025-08-06 08:39:02,045 INFO  org.apache.flink.core.plugin.DefaultPluginManager            [] - Plugin loader with ID not found, creating it: metrics-statsd
2025-08-06 08:39:02,045 INFO  org.apache.flink.core.plugin.DefaultPluginManager            [] - Plugin loader with ID not found, creating it: s3
2025-08-06 08:39:02,149 INFO  org.apache.flink.runtime.entrypoint.ClusterEntrypoint        [] - Install security context.
2025-08-06 08:39:02,150 INFO  org.apache.flink.runtime.security.modules.HadoopModuleFactory [] - Cannot create Hadoop Security Module because Hadoop cannot be found in the Classpath.
2025-08-06 08:39:02,151 INFO  org.apache.flink.runtime.security.contexts.HadoopSecurityContextFactory [] - Cannot install HadoopSecurityContext because Hadoop cannot be found in the Classpath.
2025-08-06 08:39:02,213 INFO  org.apache.flink.runtime.entrypoint.ClusterEntrypoint        [] - Initializing cluster services.
2025-08-06 08:39:02,217 INFO  org.apache.flink.runtime.entrypoint.ClusterEntrypoint        [] - Using working directory: WorkingDirectory(/tmp/jm_4985eb30c5428691ee707a5543807a8f).
2025-08-06 08:39:02,542 INFO  org.apache.flink.runtime.rpc.pekko.PekkoRpcServiceUtils      [] - Trying to start actor system, external address 192.168.10.247:6123, bind address 0.0.0.0:6123.
2025-08-06 08:39:03,330 INFO  org.apache.pekko.event.slf4j.Slf4jLogger                     [] - Slf4jLogger started
2025-08-06 08:39:03,357 INFO  org.apache.pekko.remote.RemoteActorRefProvider               [] - Pekko Cluster not in use - enabling unsafe features anyway because `pekko.remote.use-unsafe-remote-features-outside-cluster` has been enabled.
2025-08-06 08:39:03,357 INFO  org.apache.pekko.remote.Remoting                             [] - Starting remoting
2025-08-06 08:39:03,641 INFO  org.apache.pekko.remote.Remoting                             [] - Remoting started; listening on addresses :[pekko.tcp://flink@192.168.10.247:6123]
2025-08-06 08:39:03,931 INFO  org.apache.flink.runtime.rpc.pekko.PekkoRpcServiceUtils      [] - Actor system started at pekko.tcp://flink@192.168.10.247:6123
2025-08-06 08:39:03,947 INFO  org.apache.flink.runtime.security.token.DefaultDelegationTokenManager [] - Loading delegation token providers
2025-08-06 08:39:03,951 INFO  org.apache.flink.runtime.security.token.hadoop.HadoopFSDelegationTokenProvider [] - Hadoop FS is not available (not packaged with this application): NoClassDefFoundError : "org/apache/hadoop/conf/Configuration".
2025-08-06 08:39:03,951 INFO  org.apache.flink.runtime.security.token.DefaultDelegationTokenManager [] - Delegation token provider hadoopfs loaded and initialized
2025-08-06 08:39:03,953 INFO  org.apache.flink.runtime.security.token.DefaultDelegationTokenManager [] - Delegation token provider hbase loaded and initialized
2025-08-06 08:39:04,012 INFO  org.apache.flink.core.plugin.DefaultPluginManager            [] - Plugin loader with ID found, reusing it: external-resource-gpu
2025-08-06 08:39:04,012 INFO  org.apache.flink.core.plugin.DefaultPluginManager            [] - Plugin loader with ID found, reusing it: flink-s3-fs-presto
2025-08-06 08:39:04,012 INFO  org.apache.flink.core.plugin.DefaultPluginManager            [] - Plugin loader with ID found, reusing it: metrics-datadog
2025-08-06 08:39:04,012 INFO  org.apache.flink.core.plugin.DefaultPluginManager            [] - Plugin loader with ID found, reusing it: metrics-graphite
2025-08-06 08:39:04,012 INFO  org.apache.flink.core.plugin.DefaultPluginManager            [] - Plugin loader with ID found, reusing it: metrics-influx
2025-08-06 08:39:04,012 INFO  org.apache.flink.core.plugin.DefaultPluginManager            [] - Plugin loader with ID found, reusing it: metrics-jmx
2025-08-06 08:39:04,012 INFO  org.apache.flink.core.plugin.DefaultPluginManager            [] - Plugin loader with ID found, reusing it: metrics-prometheus
2025-08-06 08:39:04,012 INFO  org.apache.flink.core.plugin.DefaultPluginManager            [] - Plugin loader with ID found, reusing it: metrics-slf4j
2025-08-06 08:39:04,012 INFO  org.apache.flink.core.plugin.DefaultPluginManager            [] - Plugin loader with ID found, reusing it: metrics-statsd
2025-08-06 08:39:04,012 INFO  org.apache.flink.core.plugin.DefaultPluginManager            [] - Plugin loader with ID found, reusing it: s3
2025-08-06 08:39:04,015 INFO  org.apache.flink.runtime.security.token.DefaultDelegationTokenManager [] - Delegation token provider s3-presto loaded and initialized
2025-08-06 08:39:04,017 INFO  org.apache.flink.runtime.security.token.DefaultDelegationTokenManager [] - Delegation token provider s3-hadoop loaded and initialized
2025-08-06 08:39:04,018 INFO  org.apache.flink.runtime.security.token.DefaultDelegationTokenManager [] - Delegation token providers loaded successfully
2025-08-06 08:39:04,018 INFO  org.apache.flink.runtime.security.token.DelegationTokenReceiverRepository [] - Loading delegation token receivers
2025-08-06 08:39:04,020 INFO  org.apache.flink.runtime.security.token.DelegationTokenReceiverRepository [] - Delegation token receiver hadoopfs loaded and initialized
2025-08-06 08:39:04,021 INFO  org.apache.flink.runtime.security.token.DelegationTokenReceiverRepository [] - Delegation token receiver hbase loaded and initialized
2025-08-06 08:39:04,021 INFO  org.apache.flink.core.plugin.DefaultPluginManager            [] - Plugin loader with ID found, reusing it: external-resource-gpu
2025-08-06 08:39:04,021 INFO  org.apache.flink.core.plugin.DefaultPluginManager            [] - Plugin loader with ID found, reusing it: flink-s3-fs-presto
2025-08-06 08:39:04,021 INFO  org.apache.flink.core.plugin.DefaultPluginManager            [] - Plugin loader with ID found, reusing it: metrics-datadog
2025-08-06 08:39:04,021 INFO  org.apache.flink.core.plugin.DefaultPluginManager            [] - Plugin loader with ID found, reusing it: metrics-graphite
2025-08-06 08:39:04,021 INFO  org.apache.flink.core.plugin.DefaultPluginManager            [] - Plugin loader with ID found, reusing it: metrics-influx
2025-08-06 08:39:04,021 INFO  org.apache.flink.core.plugin.DefaultPluginManager            [] - Plugin loader with ID found, reusing it: metrics-jmx
2025-08-06 08:39:04,021 INFO  org.apache.flink.core.plugin.DefaultPluginManager            [] - Plugin loader with ID found, reusing it: metrics-prometheus
2025-08-06 08:39:04,021 INFO  org.apache.flink.core.plugin.DefaultPluginManager            [] - Plugin loader with ID found, reusing it: metrics-slf4j
2025-08-06 08:39:04,021 INFO  org.apache.flink.core.plugin.DefaultPluginManager            [] - Plugin loader with ID found, reusing it: metrics-statsd
2025-08-06 08:39:04,022 INFO  org.apache.flink.core.plugin.DefaultPluginManager            [] - Plugin loader with ID found, reusing it: s3
2025-08-06 08:39:04,023 INFO  org.apache.flink.runtime.security.token.DelegationTokenReceiverRepository [] - Delegation token receiver s3-presto loaded and initialized
2025-08-06 08:39:04,024 INFO  org.apache.flink.runtime.security.token.DelegationTokenReceiverRepository [] - Delegation token receiver s3-hadoop loaded and initialized
2025-08-06 08:39:04,024 INFO  org.apache.flink.runtime.security.token.DelegationTokenReceiverRepository [] - Delegation token receivers loaded successfully
2025-08-06 08:39:04,024 INFO  org.apache.flink.runtime.security.token.DefaultDelegationTokenManager [] - Checking provider and receiver instances consistency
2025-08-06 08:39:04,024 INFO  org.apache.flink.runtime.security.token.DefaultDelegationTokenManager [] - Provider and receiver instances are consistent
2025-08-06 08:39:04,025 WARN  org.apache.flink.runtime.security.token.DefaultDelegationTokenManager [] - Multiple providers loaded with the same prefix: s3. This might lead to unintended consequences, please consider using only one of them.
2025-08-06 08:39:04,025 INFO  org.apache.flink.runtime.security.token.DefaultDelegationTokenManager [] - Obtaining delegation tokens
2025-08-06 08:39:04,027 INFO  org.apache.flink.runtime.security.token.DefaultDelegationTokenManager [] - Delegation tokens obtained successfully
2025-08-06 08:39:04,027 WARN  org.apache.flink.runtime.security.token.DefaultDelegationTokenManager [] - No tokens obtained so skipping notifications
2025-08-06 08:39:04,925 INFO  org.apache.flink.fs.s3.common.token.AbstractS3DelegationTokenReceiver [] - Updating Hadoop configuration
2025-08-06 08:39:04,927 INFO  org.apache.flink.fs.s3.common.token.AbstractS3DelegationTokenReceiver [] - Updated Hadoop configuration successfully
2025-08-06 08:39:05,230 WARN  org.apache.hadoop.metrics2.impl.MetricsConfig                [] - Cannot locate configuration: tried hadoop-metrics2-s3a-file-system.properties,hadoop-metrics2.properties
2025-08-06 08:39:05,247 INFO  org.apache.hadoop.metrics2.impl.MetricsSystemImpl            [] - Scheduled Metric snapshot period at 10 second(s).
2025-08-06 08:39:05,247 INFO  org.apache.hadoop.metrics2.impl.MetricsSystemImpl            [] - s3a-file-system metrics system started
2025-08-06 08:39:05,337 WARN  org.apache.hadoop.util.NativeCodeLoader                      [] - Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
2025-08-06 08:39:06,329 INFO  org.apache.flink.kubernetes.kubeclient.Fabric8FlinkKubeClient [] - Creating configmap shared watcher for flink-kafka-s3-cluster-config-map.
2025-08-06 08:39:07,061 INFO  org.apache.flink.runtime.blob.BlobServer                     [] - Created BLOB server storage directory /tmp/jm_4985eb30c5428691ee707a5543807a8f/blobStorage
2025-08-06 08:39:07,063 INFO  org.apache.flink.runtime.blob.BlobServer                     [] - Started BLOB server at 0.0.0.0:6124 - max concurrent requests: 50 - max backlog: 1000
2025-08-06 08:39:07,116 INFO  org.apache.flink.runtime.metrics.MetricRegistryImpl          [] - No metrics reporter configured, no metrics will be exposed/reported.
2025-08-06 08:39:07,116 INFO  org.apache.flink.runtime.metrics.MetricRegistryImpl          [] - No trace reporter configured, no metrics will be exposed/reported.
2025-08-06 08:39:07,120 INFO  org.apache.flink.runtime.rpc.pekko.PekkoRpcServiceUtils      [] - Trying to start actor system, external address 192.168.10.247:0, bind address 0.0.0.0:0.
2025-08-06 08:39:07,141 INFO  org.apache.pekko.event.slf4j.Slf4jLogger                     [] - Slf4jLogger started
2025-08-06 08:39:07,144 INFO  org.apache.pekko.remote.RemoteActorRefProvider               [] - Pekko Cluster not in use - enabling unsafe features anyway because `pekko.remote.use-unsafe-remote-features-outside-cluster` has been enabled.
2025-08-06 08:39:07,145 INFO  org.apache.pekko.remote.Remoting                             [] - Starting remoting
2025-08-06 08:39:07,217 INFO  org.apache.pekko.remote.Remoting                             [] - Remoting started; listening on addresses :[pekko.tcp://flink-metrics@192.168.10.247:35579]
2025-08-06 08:39:07,223 INFO  org.apache.flink.runtime.rpc.pekko.PekkoRpcServiceUtils      [] - Actor system started at pekko.tcp://flink-metrics@192.168.10.247:35579
2025-08-06 08:39:07,233 INFO  org.apache.flink.runtime.rpc.pekko.PekkoRpcService           [] - Starting RPC endpoint for org.apache.flink.runtime.metrics.dump.MetricQueryService at pekko://flink-metrics/user/rpc/MetricQueryService .
2025-08-06 08:39:07,417 INFO  org.apache.flink.runtime.jobmaster.MiniDispatcherRestEndpoint [] - Upload directory /tmp/flink-web-51075f4e-65fb-47e0-ac14-b9333d742f8d/flink-web-upload does not exist. 
2025-08-06 08:39:07,418 INFO  org.apache.flink.runtime.jobmaster.MiniDispatcherRestEndpoint [] - Created directory /tmp/flink-web-51075f4e-65fb-47e0-ac14-b9333d742f8d/flink-web-upload for file uploads.
2025-08-06 08:39:07,420 INFO  org.apache.flink.runtime.jobmaster.MiniDispatcherRestEndpoint [] - Starting rest endpoint.
2025-08-06 08:39:07,461 WARN  org.apache.flink.configuration.Configuration                 [] - Config uses deprecated configuration key 'state.savepoints.dir' instead of proper key 'execution.checkpointing.savepoint-dir'
2025-08-06 08:39:07,533 INFO  org.apache.flink.runtime.webmonitor.WebMonitorUtils          [] - Determined location of main cluster component log file: /usr/lib/flink/log/flink--kubernetes-application-0-flink-kafka-s3-6cc94dcddd-wxp9z.log
2025-08-06 08:39:07,533 INFO  org.apache.flink.runtime.webmonitor.WebMonitorUtils          [] - Determined location of main cluster component stdout file: /usr/lib/flink/log/flink--kubernetes-application-0-flink-kafka-s3-6cc94dcddd-wxp9z.out
2025-08-06 08:39:07,677 INFO  org.apache.flink.runtime.jobmaster.MiniDispatcherRestEndpoint [] - Rest endpoint listening at 192.168.10.247:8081
2025-08-06 08:39:07,682 INFO  org.apache.flink.kubernetes.kubeclient.resources.KubernetesLeaderElector [] - Create KubernetesLeaderElector on lock ConfigMapLock: emr-flink - flink-kafka-s3-cluster-config-map (fe21a47a-72b0-4cb4-aab4-956b9655f4d5).
2025-08-06 08:39:07,683 INFO  org.apache.flink.kubernetes.kubeclient.resources.KubernetesConfigMapSharedInformer [] - Starting to watch for emr-flink/flink-kafka-s3-cluster-config-map, watching id:2c007e72-7174-4d0f-9d9a-af1624f45d58
2025-08-06 08:39:07,685 INFO  org.apache.flink.kubernetes.kubeclient.resources.KubernetesLeaderElector [] - Triggered leader election on lock ConfigMapLock: emr-flink - flink-kafka-s3-cluster-config-map (fe21a47a-72b0-4cb4-aab4-956b9655f4d5).
2025-08-06 08:39:07,685 INFO  org.apache.flink.runtime.leaderelection.DefaultLeaderElectionService [] - A connection to the HA backend was established through LeaderElectionDriver KubernetesLeaderElectionDriver{configMapName='flink-kafka-s3-cluster-config-map'}.
2025-08-06 08:39:07,685 INFO  org.apache.flink.runtime.leaderelection.DefaultLeaderElectionService [] - LeaderContender has been registered under component 'restserver' for KubernetesLeaderElectionDriver{configMapName='flink-kafka-s3-cluster-config-map'}.
2025-08-06 08:39:07,712 INFO  org.apache.flink.runtime.jobmaster.MiniDispatcherRestEndpoint [] - Web frontend listening at http://192.168.10.247:8081.
2025-08-06 08:39:07,726 WARN  org.apache.flink.kubernetes.entrypoint.KubernetesResourceManagerFactory [] - Configured size for 'taskmanager.memory.process.size' is ignored. Total memory size for TaskManagers are dynamically decided in fine-grained resource management.
2025-08-06 08:39:07,731 INFO  org.apache.flink.runtime.leaderelection.DefaultLeaderElectionService [] - LeaderContender has been registered under component 'dispatcher' for KubernetesLeaderElectionDriver{configMapName='flink-kafka-s3-cluster-config-map'}.
2025-08-06 08:39:07,732 INFO  org.apache.flink.runtime.resourcemanager.ResourceManagerServiceImpl [] - Starting resource manager service.
2025-08-06 08:39:07,732 INFO  org.apache.flink.runtime.leaderelection.DefaultLeaderElectionService [] - LeaderContender has been registered under component 'resourcemanager' for KubernetesLeaderElectionDriver{configMapName='flink-kafka-s3-cluster-config-map'}.
2025-08-06 08:39:07,734 INFO  org.apache.flink.kubernetes.kubeclient.resources.KubernetesConfigMapSharedInformer [] - Starting to watch for emr-flink/flink-kafka-s3-cluster-config-map, watching id:e4d46c50-30be-4e7d-8845-486fb1a8ee0c
2025-08-06 08:39:07,734 INFO  org.apache.flink.runtime.leaderretrieval.DefaultLeaderRetrievalService [] - Starting DefaultLeaderRetrievalService with KubernetesLeaderRetrievalDriver{configMapName='flink-kafka-s3-cluster-config-map'}.
2025-08-06 08:39:07,734 INFO  org.apache.flink.runtime.leaderretrieval.DefaultLeaderRetrievalService [] - Starting DefaultLeaderRetrievalService with KubernetesLeaderRetrievalDriver{configMapName='flink-kafka-s3-cluster-config-map'}.
2025-08-06 08:39:07,734 INFO  org.apache.flink.kubernetes.kubeclient.resources.KubernetesConfigMapSharedInformer [] - Starting to watch for emr-flink/flink-kafka-s3-cluster-config-map, watching id:5d2cb9a7-adf4-41ac-9f4a-0023065f8096
2025-08-06 08:39:07,834 ERROR org.apache.flink.kubernetes.shaded.io.fabric8.kubernetes.client.extended.leaderelection.LeaderElector [] - Exception occurred while acquiring lock 'ConfigMapLock: emr-flink - flink-kafka-s3-cluster-config-map (fe21a47a-72b0-4cb4-aab4-956b9655f4d5) retrying...'
org.apache.flink.kubernetes.shaded.io.fabric8.kubernetes.client.KubernetesClientException: Failure executing: POST at: https://10.100.0.1:443/api/v1/namespaces/emr-flink/configmaps. Message: configmaps "flink-kafka-s3-cluster-config-map" already exists. Received status: Status(apiVersion=v1, code=409, details=StatusDetails(causes=[], group=null, kind=configmaps, name=flink-kafka-s3-cluster-config-map, retryAfterSeconds=null, uid=null, additionalProperties={}), kind=Status, message=configmaps "flink-kafka-s3-cluster-config-map" already exists, metadata=ListMeta(_continue=null, remainingItemCount=null, resourceVersion=null, selfLink=null, additionalProperties={}), reason=AlreadyExists, status=Failure, additionalProperties={}).
	at org.apache.flink.kubernetes.shaded.io.fabric8.kubernetes.client.KubernetesClientException.copyAsCause(KubernetesClientException.java:238) ~[flink-dist-1.20.0-amzn-3.jar:1.20.0-amzn-3]
	at org.apache.flink.kubernetes.shaded.io.fabric8.kubernetes.client.dsl.internal.OperationSupport.waitForResult(OperationSupport.java:507) ~[flink-dist-1.20.0-amzn-3.jar:1.20.0-amzn-3]
	at org.apache.flink.kubernetes.shaded.io.fabric8.kubernetes.client.dsl.internal.OperationSupport.handleResponse(OperationSupport.java:524) ~[flink-dist-1.20.0-amzn-3.jar:1.20.0-amzn-3]
	at org.apache.flink.kubernetes.shaded.io.fabric8.kubernetes.client.dsl.internal.OperationSupport.handleCreate(OperationSupport.java:340) ~[flink-dist-1.20.0-amzn-3.jar:1.20.0-amzn-3]
	at org.apache.flink.kubernetes.shaded.io.fabric8.kubernetes.client.dsl.internal.BaseOperation.handleCreate(BaseOperation.java:753) ~[flink-dist-1.20.0-amzn-3.jar:1.20.0-amzn-3]
	at org.apache.flink.kubernetes.shaded.io.fabric8.kubernetes.client.dsl.internal.BaseOperation.handleCreate(BaseOperation.java:97) ~[flink-dist-1.20.0-amzn-3.jar:1.20.0-amzn-3]
	at org.apache.flink.kubernetes.shaded.io.fabric8.kubernetes.client.dsl.internal.CreateOnlyResourceOperation.create(CreateOnlyResourceOperation.java:42) ~[flink-dist-1.20.0-amzn-3.jar:1.20.0-amzn-3]
	at org.apache.flink.kubernetes.shaded.io.fabric8.kubernetes.client.dsl.internal.BaseOperation.create(BaseOperation.java:1142) ~[flink-dist-1.20.0-amzn-3.jar:1.20.0-amzn-3]
	at org.apache.flink.kubernetes.shaded.io.fabric8.kubernetes.client.dsl.internal.BaseOperation.create(BaseOperation.java:97) ~[flink-dist-1.20.0-amzn-3.jar:1.20.0-amzn-3]
	at org.apache.flink.kubernetes.shaded.io.fabric8.kubernetes.client.extension.ResourceAdapter.create(ResourceAdapter.java:114) ~[flink-dist-1.20.0-amzn-3.jar:1.20.0-amzn-3]
	at org.apache.flink.kubernetes.shaded.io.fabric8.kubernetes.client.extended.leaderelection.resourcelock.ResourceLock.create(ResourceLock.java:58) ~[flink-dist-1.20.0-amzn-3.jar:1.20.0-amzn-3]
	at org.apache.flink.kubernetes.shaded.io.fabric8.kubernetes.client.extended.leaderelection.LeaderElector.tryAcquireOrRenew(LeaderElector.java:220) ~[flink-dist-1.20.0-amzn-3.jar:1.20.0-amzn-3]
	at org.apache.flink.kubernetes.shaded.io.fabric8.kubernetes.client.extended.leaderelection.LeaderElector.lambda$acquire$4(LeaderElector.java:172) ~[flink-dist-1.20.0-amzn-3.jar:1.20.0-amzn-3]
	at org.apache.flink.kubernetes.shaded.io.fabric8.kubernetes.client.extended.leaderelection.LeaderElector.lambda$loop$8(LeaderElector.java:282) ~[flink-dist-1.20.0-amzn-3.jar:1.20.0-amzn-3]
	at java.util.concurrent.CompletableFuture$AsyncRun.run(CompletableFuture.java:1804) [?:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) [?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) [?:?]
	at java.lang.Thread.run(Thread.java:840) [?:?]
Caused by: org.apache.flink.kubernetes.shaded.io.fabric8.kubernetes.client.KubernetesClientException: Failure executing: POST at: https://10.100.0.1:443/api/v1/namespaces/emr-flink/configmaps. Message: configmaps "flink-kafka-s3-cluster-config-map" already exists. Received status: Status(apiVersion=v1, code=409, details=StatusDetails(causes=[], group=null, kind=configmaps, name=flink-kafka-s3-cluster-config-map, retryAfterSeconds=null, uid=null, additionalProperties={}), kind=Status, message=configmaps "flink-kafka-s3-cluster-config-map" already exists, metadata=ListMeta(_continue=null, remainingItemCount=null, resourceVersion=null, selfLink=null, additionalProperties={}), reason=AlreadyExists, status=Failure, additionalProperties={}).
	at org.apache.flink.kubernetes.shaded.io.fabric8.kubernetes.client.dsl.internal.OperationSupport.requestFailure(OperationSupport.java:660) ~[flink-dist-1.20.0-amzn-3.jar:1.20.0-amzn-3]
	at org.apache.flink.kubernetes.shaded.io.fabric8.kubernetes.client.dsl.internal.OperationSupport.requestFailure(OperationSupport.java:640) ~[flink-dist-1.20.0-amzn-3.jar:1.20.0-amzn-3]
	at org.apache.flink.kubernetes.shaded.io.fabric8.kubernetes.client.dsl.internal.OperationSupport.assertResponseCode(OperationSupport.java:589) ~[flink-dist-1.20.0-amzn-3.jar:1.20.0-amzn-3]
	at org.apache.flink.kubernetes.shaded.io.fabric8.kubernetes.client.dsl.internal.OperationSupport.lambda$handleResponse$0(OperationSupport.java:549) ~[flink-dist-1.20.0-amzn-3.jar:1.20.0-amzn-3]
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:646) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2147) ~[?:?]
	at org.apache.flink.kubernetes.shaded.io.fabric8.kubernetes.client.http.StandardHttpClient.lambda$completeOrCancel$10(StandardHttpClient.java:140) ~[flink-dist-1.20.0-amzn-3.jar:1.20.0-amzn-3]
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:863) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:841) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2147) ~[?:?]
	at org.apache.flink.kubernetes.shaded.io.fabric8.kubernetes.client.http.ByteArrayBodyHandler.onBodyDone(ByteArrayBodyHandler.java:52) ~[flink-dist-1.20.0-amzn-3.jar:1.20.0-amzn-3]
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:863) ~[?:?]
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:841) ~[?:?]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]
	at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2147) ~[?:?]
	at org.apache.flink.kubernetes.shaded.io.fabric8.kubernetes.client.okhttp.OkHttpClientImpl$OkHttpAsyncBody.doConsume(OkHttpClientImpl.java:136) ~[flink-dist-1.20.0-amzn-3.jar:1.20.0-amzn-3]
	... 3 more
2025-08-06 08:39:13,535 INFO  org.apache.flink.kubernetes.kubeclient.resources.KubernetesLeaderElector [] - New leader elected 40655965-027e-4fe0-8ca5-090341a8bca4 for flink-kafka-s3-cluster-config-map.
